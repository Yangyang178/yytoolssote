{% extends 'base.html' %}

{% block head %}
    {{ super() }}
    <link rel="stylesheet" href="{{ url_for('static', filename='user_center.css') }}">
{% endblock %}

{% block content %}
<div class="user-center-container">
    <div class="container">
        <div class="page-header">
            <h1 class="page-title">ç”¨æˆ·ä¸­å¿ƒ</h1>
        </div>
        
        {% if user %}
            <!-- ç”¨æˆ·ä¿¡æ¯å¡ç‰‡ -->
            <div class="user-profile-card">
                <div class="profile-header">
                    <div class="profile-info">
                        <div class="avatar-section">
                            <div class="user-avatar">
                                {% if user.avatar %}
                                    <img data-src="{{ url_for('static', filename='avatars/' + (user.avatar or '')) }}" alt="ç”¨æˆ·å¤´åƒ" class="avatar-image" loading="lazy">
                                {% else %}
                                    <div class="avatar-icon">{{ (user.username or '')[0] | upper if user.username else 'U' }}</div>
                                {% endif %}
                            </div>
                            <div class="profile-details">
                                <h2 class="user-name">{{ user.username }}</h2>
                                <p class="user-email">{{ user.email }}</p>
                            </div>
                        </div>
                        <div class="profile-stats">
                            <div class="stat-item">
                                <span class="stat-number">{{ files | length }}</span>
                                <span class="stat-label">ä¸Šä¼ æ–‡ä»¶</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-number">{{ folder_count }}</span>
                                <span class="stat-label">é¡¹ç›®æ–‡ä»¶å¤¹</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-number">{{ favorite_count }}</span>
                                <span class="stat-label">æ”¶è—æ–‡ä»¶</span>
                            </div>
                        </div>
                    </div>
                    <div class="profile-actions">
                        <button class="btn btn-edit" id="edit-profile-btn">
                            <i class="icon-edit">âœï¸</i> ç¼–è¾‘èµ„æ–™
                        </button>
                        <a href="{{ url_for('account_settings') }}" class="btn btn-account">
                            <i class="icon-account">âš™ï¸</i> è´¦æˆ·è®¾ç½®
                        </a>
                        <a href="#" class="btn btn-logout" id="logout-btn">
                            <i class="icon-logout">ğŸšª</i> é€€å‡ºç™»å½•
                        </a>
                    </div>
                </div>
                <!-- é¡¹ç›®å¡ç‰‡å®¹å™¨ -->
                <div class="project-cards-container">
                    <!-- é¡¹ç›®æ–‡ä»¶å¡ç‰‡ -->
                    <div class="project-card">
                        <div class="project-card-header">
                            <div class="project-icon">
                                <div class="folder-icon">ğŸ“</div>
                            </div>
                            <div class="project-info">
                                <h3 class="project-title">é¡¹ç›®æ–‡ä»¶å¤¹</h3>
                                <p class="project-desc">å¤šæ–‡ä»¶é¡¹ç›®ç®¡ç†</p>
                            </div>
                        </div>
                        <div class="project-card-actions">
                            <a href="{{ url_for('project_folders') }}" class="btn btn-manage-projects">ç®¡ç†é¡¹ç›®æ–‡ä»¶å¤¹</a>
                        </div>
                    </div>
                    
                    <!-- åé¦ˆä¸­å¿ƒå¡ç‰‡ -->
                    <div class="project-card">
                        <div class="project-card-header">
                            <div class="project-icon" style="background: linear-gradient(135deg, #10B981, #059669);">
                                <div style="font-size: 2rem; color: white;">ğŸ’¬</div>
                            </div>
                            <div class="project-info">
                                <h3 class="project-title">åé¦ˆä¸­å¿ƒ</h3>
                                <p class="project-desc">æ„è§å»ºè®®</p>
                            </div>
                        </div>
                        <div style="display: grid; grid-template-columns: 1fr; gap: 12px; margin: 20px 0;">
                            <a href="{{ url_for('my_feedback') }}" class="btn btn-outline" style="border-color: #10B981; color: #10B981; display: flex; align-items: center; justify-content: center; text-decoration: none;">
                                <i>ğŸ“‹</i> æˆ‘çš„åé¦ˆ
                            </a>
                            <a href="{{ url_for('new_feedback') }}" class="btn" style="background: linear-gradient(135deg, #10B981, #059669); color: white; border: none; width: 100%; padding: 12px; font-size: 1rem; cursor: pointer; text-decoration: none; display: flex; align-items: center; justify-content: center;">
                                æ–°åé¦ˆ
                            </a>
                        </div>
                    </div>
                </div>
                

            </div>
            
            <!-- ç¼–è¾‘èµ„æ–™æ¨¡æ€æ¡† -->
            <div id="edit-modal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3 class="modal-title">
                            <span class="modal-icon">ğŸ‘¤</span>
                            ç¼–è¾‘ä¸ªäººèµ„æ–™
                        </h3>
                        <button class="modal-close" id="close-modal-btn">&times;</button>
                    </div>
                    <form id="edit-profile-form" action="{{ url_for('update_profile') }}" method="post" enctype="multipart/form-data">
                        <div class="modal-body">
                            <div class="form-section">
                                <div class="form-group">
                                    <label for="edit-username" class="form-label">ç”¨æˆ·å</label>
                                    <input type="text" id="edit-username" name="username" value="{{ user.username }}" class="form-input" required>
                                </div>
                                
                                <div class="form-group">
                                    <label for="edit-avatar" class="form-label">å¤´åƒ</label>
                                    <div class="avatar-upload-section">
                                        <div class="current-avatar">
                                            {% if user.avatar %}
                                                <img src="{{ url_for('static', filename='avatars/' + user.avatar) }}" alt="å½“å‰å¤´åƒ" class="avatar-preview">
                                            {% else %}
                                                <div class="avatar-icon-large">{{ user.username[0] | upper }}</div>
                                            {% endif %}
                                        </div>
                                        <div class="avatar-upload-controls">
                                            <input type="file" id="edit-avatar" name="avatar" accept="image/*" class="avatar-input">
                                            <label for="edit-avatar" class="btn btn-secondary">é€‰æ‹©æ–°å¤´åƒ</label>
                                            {% if user.avatar %}
                                                <button type="button" class="btn btn-danger" id="remove-avatar-btn">ç§»é™¤å¤´åƒ</button>
                                            {% endif %}
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label for="edit-email" class="form-label">é‚®ç®±</label>
                                    <input type="email" id="edit-email" name="email" value="{{ user.email }}" class="form-input" disabled>
                                    <p class="form-hint">é‚®ç®±åœ°å€ä¸å¯ä¿®æ”¹</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="modal-footer">
                            <button type="button" class="btn btn-cancel" id="cancel-edit-btn">å–æ¶ˆ</button>
                            <button type="submit" class="btn btn-primary">ä¿å­˜ä¿®æ”¹</button>
                        </div>
                    </form>
                </div>
            </div>
            
            <!-- å†…å®¹åŒºåŸŸ -->
            <div class="content-wrapper">
                <!-- æˆ‘çš„æ–‡ä»¶ -->
                <section class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">æˆ‘çš„æ–‡ä»¶</h2>
                        <div class="search-container">
                            <div class="search-input-wrapper">
                                <span class="search-icon">ğŸ”</span>
                                <input type="text" id="file-search" placeholder="æœç´¢æ–‡ä»¶..." class="search-input">
                                <button class="search-clear-btn" id="search-clear-btn">&times;</button>
                            </div>
                            <button class="search-btn">æœç´¢</button>
                        </div>
                        <a href="{{ url_for('upload') }}" class="btn btn-primary">
                            <i class="icon-upload">ğŸ“¤</i> ä¸Šä¼ æ–°æ–‡ä»¶
                        </a>
                    </div>
                    <div class="search-results-info" id="search-results-info"></div>
                    
                    {% if files %}
                        <div class="files-grid">
                            {% for f in files %}
                            {% set d = {} %}
                            {% if f.dkfile is defined and f.dkfile is mapping %}
                                {% set d = f.dkfile.get('data', {}) %}
                            {% endif %}
                            <div class="user-file-card" data-search="{{ f.filename }} {{ f.project_name or '' }} {{ f.project_desc or '' }} {% for category in f.categories|default([]) %}{{ category.name }} {% endfor %} {% for tag in f.tags|default([]) %}{{ tag.name }} {% endfor %}">
                                <div class="file-card-top">
                                    <div class="file-name-large">{{ f.filename }}</div>
                                    <button class="file-action-btn action-share" data-file-id="{{ f.id }}" data-file-name="{{ f.filename }}" data-file-url="{{ url_for('open_local', stored_name=f.stored_name, _external=True) }}" title="åˆ†äº«æ–‡ä»¶é“¾æ¥">
                                        åˆ†äº«
                                    </button>
                                </div>
                                <div class="file-size-info">{{ (f.size or 0) | int }} B</div>
                                <div class="file-metadata">
                                    <div class="metadata-item">
                                        <span class="metadata-label">é¡¹ç›®åç§°ï¼š</span>
                                        <span class="metadata-value">{{ f.project_name or '-' }}</span>
                                    </div>
                                    <div class="metadata-item">
                                        <span class="metadata-label">é¡¹ç›®æè¿°ï¼š</span>
                                        <span class="metadata-value">{{ f.project_desc or '-' }}</span>
                                    </div>
                                    <div class="metadata-item">
                                        <span class="metadata-label">è¿œç«¯é“¾æ¥ï¼š</span>
                                        <span class="metadata-value">{% if d and d.url %}<a href="{{ d.url }}" target="_blank">æ‰“å¼€</a>{% else %}-{% endif %}</span>
                                    </div>
                                    <div class="metadata-item">
                                        <span class="metadata-label">åˆ›å»ºæ—¶é—´ï¼š</span>
                                        <span class="metadata-value">{{ d and d.created_at or '-' }}</span>
                                    </div>
                                    {% if f.categories %}
                                    <div class="metadata-item">
                                        <span class="metadata-label">åˆ†ç±»ï¼š</span>
                                        <div class="categories-list">
                                            {% for category in f.categories %}
                                            <span class="category-tag">{{ category.name }}</span>
                                            {% endfor %}
                                        </div>
                                    </div>
                                    {% endif %}
                                    {% if f.tags %}
                                    <div class="metadata-item">
                                        <span class="metadata-label">æ ‡ç­¾ï¼š</span>
                                        <div class="tags-list">
                                            {% for tag in f.tags %}
                                            <span class="tag">{{ tag.name }}</span>
                                            {% endfor %}
                                        </div>
                                    </div>
                                    {% endif %}
                                </div>
                                <div class="file-card-actions">
                                    <a class="file-action-btn action-detail" href="{{ url_for('file_detail', file_id=f.id) }}">è¯¦æƒ…</a>
                                    <a class="file-action-btn action-download" href="{{ url_for('download_local', stored_name=f.stored_name) }}">ä¸‹è½½</a>
                                    <!-- æ›¿æ¢æ–‡ä»¶æŒ‰é’® -->
                                    <button class="file-action-btn action-replace" data-file-id="{{ f.id }}" data-file-name="{{ f.filename }}">æ›¿æ¢</button>
                                    <form class="inline" action="{{ url_for('file_delete', file_id=f.id) }}" method="post">
                                        <button class="file-action-btn action-delete" type="submit">åˆ é™¤</button>
                                    </form>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                    {% else %}
                        <div class="empty-state">
                            <div class="empty-icon">ğŸ“</div>
                            <h3 class="empty-title">æš‚æ— æ–‡ä»¶</h3>
                            <p class="empty-desc">æ‚¨è¿˜æ²¡æœ‰ä¸Šä¼ ä»»ä½•æ–‡ä»¶</p>
                            <a href="{{ url_for('upload') }}" class="btn btn-primary">
                                <i class="icon-upload">ğŸ“¤</i> ä¸Šä¼ ç¬¬ä¸€ä¸ªæ–‡ä»¶
                            </a>
                        </div>
                    {% endif %}
                </section>
                
                <!-- æ”¶è—æ–‡ä»¶ -->
                <section class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">æ”¶è—æ–‡ä»¶</h2>
                    </div>
                    
                    {% if favorite_files %}
                        <div class="files-grid">
                            {% for f in favorite_files %}
                            {% set d = {} %}
                            {% if f.dkfile is defined and f.dkfile is mapping %}
                                {% set d = f.dkfile.get('data', {}) %}
                            {% endif %}
                            <div class="file-card">
                              <div class="file-card-header">
                                <div class="file-icon-container">
                                  <div class="file-icon">
                                    <div class="file-icon-top"></div>
                                    <div class="file-icon-content"></div>
                                  </div>
                                </div>
                                <div class="file-info-header">
                                  <h3 class="file-name">
                                    {% if f.filename == 'watermark-remover.html' %}
                                      å›¾ç‰‡å»æ°´å°å·¥å…·
                                    {% elif f.filename == 'subscription_manager.html' %}
                                      è®¢é˜…æœåŠ¡ç®¡ç†å™¨
                                    {% elif f.filename == 'color_mixing_game.html' %}
                                      è‰²å½©æ··åˆå¤§å¸ˆ
                                    {% elif f.filename == 'font_pairing_recommender.html' %}
                                      å­—ä½“é…å¯¹æ¨èå™¨
                                    {% else %}
                                      {{ f.filename }}
                                    {% endif %}
                                  </h3>
                                  <div class="file-size">{{ (f.size or 0) | int }} B</div>
                                </div>
                                <div class="file-card-actions-top">
                                  <button class="file-action-btn action-share" data-file-id="{{ f.id }}" data-file-name="{{ f.filename }}" data-file-url="{{ url_for('open_local', stored_name=f.stored_name, _external=True) }}" title="åˆ†äº«æ–‡ä»¶é“¾æ¥">
                                    åˆ†äº«
                                  </button>
                                </div>
                              </div>
                              <div class="file-card-body">
                                <div class="file-project">
                                  <div class="project-name">
                                    <span class="label">é¡¹ç›®åç§°ï¼š</span>
                                    <span class="value">{{ f.project_name or '-' }}</span>
                                  </div>
                                  <div class="project-desc">
                                    <span class="label">é¡¹ç›®æè¿°ï¼š</span>
                                    <span class="value">{{ f.project_desc or '-' }}</span>
                                  </div>
                                  <div class="remote-link">
                                    <span class="label">è¿œç«¯é“¾æ¥ï¼š</span>
                                    <span class="value">{% if d and d.url %}<a href="{{ d.url }}" target="_blank">æ‰“å¼€</a>{% else %}-{% endif %}</span>
                                  </div>
                                  <div class="like-count">
                                    <span class="label">ç‚¹èµæ•°ï¼š</span>
                                    <span class="value">{{ f.like_count }}</span>
                                  </div>
                                  <div class="favorite-count">
                                    <span class="label">æ”¶è—æ•°ï¼š</span>
                                    <span class="value">{{ f.favorite_count }}</span>
                                  </div>
                                  <div class="created-time">
                                    <span class="label">åˆ›å»ºæ—¶é—´ï¼š</span>
                                    <span class="value">{{ d and d.created_at or '-' }}</span>
                                  </div>
                                </div>
                              </div>
                              <div class="file-card-footer">
                                <div class="file-actions">
                                  <a class="btn btn-detail file-action" href="{{ url_for('file_detail', file_id=f.id) }}">è¯¦æƒ…</a>
                                  <a class="btn btn-download file-action" href="{{ url_for('download_local', stored_name=f.stored_name) }}">ä¸‹è½½</a>
                                  <button class="btn btn-unfavorite file-action" data-file-id="{{ f.id }}">å–æ¶ˆæ”¶è—</button>
                                </div>
                              </div>
                            </div>
                            {% endfor %}
                        </div>
                    {% else %}
                        <div class="empty-state">
                            <div class="empty-icon">â­</div>
                            <h3 class="empty-title">æš‚æ— æ”¶è—æ–‡ä»¶</h3>
                            <p class="empty-desc">æ‚¨è¿˜æ²¡æœ‰æ”¶è—ä»»ä½•æ–‡ä»¶ï¼Œå»é¦–é¡µæ¢ç´¢å¹¶æ”¶è—æ„Ÿå…´è¶£çš„æ–‡ä»¶å§</p>
                            <a href="{{ url_for('index') }}" class="btn btn-primary">
                                <i class="icon-explore">ğŸ”</i> å»é¦–é¡µæ¢ç´¢
                            </a>
                        </div>
                    {% endif %}
                </section>
                
                <!-- è®¿é—®è®°å½• -->
                <section class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">è®¿é—®è®°å½•</h2>
                        <button class="toggle-btn" id="toggle-logs-btn">
                            <span id="toggle-icon">â–¼</span>
                        </button>
                    </div>
                    
                    {% if access_logs %}
                        <div id="logs-container" class="logs-container">
                            <table class="logs-table">
                                <thead>
                                    <tr>
                                        <th>æ–‡ä»¶å</th>
                                        <th>æ“ä½œç±»å‹</th>
                                        <th>IPåœ°å€</th>
                                        <th>è®¿é—®æ—¶é—´</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for log in access_logs %}
                                    <tr class="log-row">
                                        <td>{{ log.filename }}</td>
                                        <td>
                                            {% if log.action == 'view' %}
                                                <span class="action-tag action-view">æŸ¥çœ‹</span>
                                            {% elif log.action == 'download' %}
                                                <span class="action-tag action-download">ä¸‹è½½</span>
                                            {% else %}
                                                <span class="action-tag action-other">{{ log.action }}</span>
                                            {% endif %}
                                        </td>
                                        <td>{{ log.ip_address }}</td>
                                        <td>{{ log.access_time }}</td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    {% else %}
                        <div id="logs-container" class="logs-container">
                            <div class="empty-state">
                                <div class="empty-icon">ğŸ“‹</div>
                                <h3 class="empty-title">æš‚æ— è®¿é—®è®°å½•</h3>
                                <p class="empty-desc">å½“æœ‰ç”¨æˆ·è®¿é—®æ‚¨çš„æ–‡ä»¶æ—¶ï¼Œè¿™é‡Œä¼šæ˜¾ç¤ºè®¿é—®è®°å½•</p>
                            </div>
                        </div>
                    {% endif %}
                </section>
                
                <!-- æ“ä½œæ—¥å¿— -->
                <section class="content-section">
                    <div class="section-header">
                        <h2 class="section-title">æ“ä½œæ—¥å¿—</h2>
                        <button class="toggle-btn" id="toggle-operation-logs-btn">
                            <span id="toggle-operation-icon">â–¼</span>
                        </button>
                    </div>
                    
                    <div id="operation-logs-container" class="logs-container">
                        {% if operation_logs %}
                            <table class="logs-table">
                                <thead>
                                    <tr>
                                        <th>æ“ä½œç±»å‹</th>
                                        <th>ç›®æ ‡ç±»å‹</th>
                                        <th>æ“ä½œæ¶ˆæ¯</th>
                                        <th>è¯¦ç»†ä¿¡æ¯</th>
                                        <th>æ“ä½œæ—¶é—´</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for log in operation_logs %}
                                    <tr class="log-row">
                                        <td>
                                            {% if log.action == 'upload' %}
                                                <span class="action-tag action-upload">ä¸Šä¼ </span>
                                            {% elif log.action == 'delete' %}
                                                <span class="action-tag action-delete">åˆ é™¤</span>
                                            {% elif log.action == 'edit' %}
                                                <span class="action-tag action-edit">ç¼–è¾‘</span>
                                            {% else %}
                                                <span class="action-tag action-other">{{ log.action }}</span>
                                            {% endif %}
                                        </td>
                                        <td>{{ log.target_type or 'æœªçŸ¥' }}</td>
                                        <td>{{ log.message }}</td>
                                        <td>{{ log.details or '-' }}</td>
                                        <td>{{ log.created_at }}</td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        {% else %}
                            <div class="empty-state">
                                <div class="empty-icon">ğŸ“</div>
                                <h3 class="empty-title">æš‚æ— æ“ä½œæ—¥å¿—</h3>
                                <p class="empty-desc">å½“æ‚¨è¿›è¡Œä¸Šä¼ ã€åˆ é™¤ç­‰æ“ä½œæ—¶ï¼Œè¿™é‡Œä¼šæ˜¾ç¤ºæ“ä½œè®°å½•</p>
                            </div>
                        {% endif %}
                    </div>
                </section>
            </div>
        {% else %}
            <!-- æœªç™»å½•çŠ¶æ€ -->
            <div class="not-logged-in">
                <div class="login-prompt">
                    <div class="prompt-icon">ğŸ‘¤</div>
                    <h2 class="prompt-title">æ‚¨å°šæœªç™»å½•</h2>
                    <p class="prompt-desc">ç™»å½•åï¼Œæ‚¨å¯ä»¥æŸ¥çœ‹å’Œç®¡ç†æ‚¨çš„æ–‡ä»¶ï¼Œäº«å—å®Œæ•´çš„æ™ºèƒ½æ–‡ä»¶ç®¡ç†ç³»ç»ŸåŠŸèƒ½</p>
                    <div class="prompt-actions">
                        <a href="{{ url_for('auth') }}?mode=login" class="btn btn-primary">ç™»å½•</a>
                        <a href="{{ url_for('auth') }}?mode=register" class="btn btn-outline">æ³¨å†Œ</a>
                    </div>
                </div>
            </div>
        {% endif %}
    </div>
</div>

<!-- æ›¿æ¢æ–‡ä»¶æ¨¡æ€æ¡† -->
<div id="replaceModal" class="modal hidden">
    <div class="modal-content">
        <div class="modal-header">
            <h3 class="modal-title">
                <span class="modal-icon">ğŸ”„</span>
                æ›¿æ¢æ–‡ä»¶
            </h3>
            <button class="modal-close" onclick="closeReplaceModal()">&times;</button>
        </div>
        <div class="modal-body">
            <form id="replaceFileForm" action="{{ url_for('file_replace') }}" method="post" enctype="multipart/form-data">
                <input type="hidden" id="replaceFileId" name="file_id">
                <div class="form-section">
                    <div class="form-group">
                        <label for="replaceFile" class="form-label">é€‰æ‹©æ–°æ–‡ä»¶</label>
                        <div class="modern-file-upload">
                            <input type="file" id="replaceFile" name="file" required class="file-input">
                            <label for="replaceFile" class="file-label">
                                <div class="upload-icon">ğŸ“</div>
                                <div class="upload-info">
                                    <span class="upload-text">ç‚¹å‡»é€‰æ‹©æ–‡ä»¶æˆ–æ‹–æ‹½æ–‡ä»¶åˆ°æ­¤å¤„</span>
                                    <span class="upload-hint">æ”¯æŒå¤šç§æ–‡ä»¶æ ¼å¼ï¼Œå•ä¸ªæ–‡ä»¶ä¸è¶…è¿‡200MB</span>
                                    <span class="file-size"></span>
                                </div>
                            </label>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="versionComment" class="form-label">ç‰ˆæœ¬å¤‡æ³¨ï¼ˆå¯é€‰ï¼‰</label>
                        <textarea 
                            id="versionComment" 
                            name="comment" 
                            rows="3" 
                            placeholder="è¯·è¾“å…¥ç‰ˆæœ¬æ›´æ–°è¯´æ˜ï¼Œä¾‹å¦‚ï¼šä¿®å¤äº†æŸäº›åŠŸèƒ½æˆ–æ·»åŠ äº†æ–°ç‰¹æ€§" 
                            class="form-textarea"
                        ></textarea>
                    </div>
                </div>
                
                <div class="modal-footer">
                    <button type="button" class="btn btn-cancel" onclick="closeReplaceModal()">
                        <span class="btn-icon">âœ•</span>
                        å–æ¶ˆ
                    </button>
                    <button type="submit" class="btn btn-primary btn-submit">
                        <span class="btn-icon">ğŸš€</span>
                        æ›¿æ¢æ–‡ä»¶
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<div id="app-data" data-is-logged-in="{{ user is not none | tojson | safe }}" class="hidden"></div>

<script src="{{ url_for('static', filename='user_center.js') }}"></script>

{% endblock %}