{% extends 'base.html' %}
{% block content %}
{% if not_found %}
  <div class="empty">未找到文件</div>
{% else %}
  <section class="panel" style="margin-top: 160px; padding: 30px;">
    <h2>文件详情</h2>
    <div class="grid">
      <div>
        <div class="kv"><span>文件名</span><strong>{{ item.filename }}</strong></div>
        <div class="kv"><span>大小</span><strong>{{ (item.size or 0) | int }} B</strong></div>
        <div class="kv"><span>本地路径</span><strong>{{ item.path }}</strong></div>
        {% if item.project_name %}
        <div class="kv"><span>项目名称</span><strong>{{ item.project_name }}</strong></div>
        {% endif %}
        {% if item.project_desc %}
        <div class="kv"><span>项目描述</span><strong>{{ item.project_desc }}</strong></div>
        {% endif %}
        <div class="actions">
          <a class="btn" href="{{ url_for('download_local', stored_name=item.stored_name) }}">下载</a>
          <form class="inline" action="{{ url_for('file_delete', file_id=item.id) }}" method="post">
            <button class="btn danger" type="submit" onclick="return confirm('确定要删除这个文件吗？此操作不可恢复。')">删除</button>
          </form>
        </div>
      </div>
      <div>
        <h3>DKFile 响应</h3>
        {% if item.dkfile %}
          {% set d = item.dkfile.data if item.dkfile and item.dkfile.success else None %}
          {% if d and d.url %}
            <div class="kv"><span>远端地址</span><strong><a href="{{ d.url }}" target="_blank">{{ d.url }}</a></strong></div>
            <div class="kv"><span>创建时间</span><strong>{{ d.created_at }}</strong></div>
            {% if d.updated_at %}
            <div class="kv"><span>更新时间</span><strong>{{ d.updated_at }}</strong></div>
            {% endif %}
          {% endif %}
          <pre class="code">{{ item.dkfile | tojson(indent=2) }}</pre>
        {% else %}
          <div class="empty">暂无</div>
        {% endif %}
      </div>
    </div>
  </section>
{% endif %}
{% endblock %}
